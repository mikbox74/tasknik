(this.webpackJsonptasknik=this.webpackJsonptasknik||[]).push([[0],[,,,,,,,function(e){e.exports=JSON.parse('{"name":"tasknik","version":"0.6.1","private":true,"homepage":"http://mikbox74.github.io/tasknik","dependencies":{"@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.4.0","@testing-library/user-event":"^7.2.1","gh-pages":"^2.2.0","prop-types":"^15.7.2","react":"^16.12.0","react-dom":"^16.12.0","react-feather":"^2.0.9"},"devDependencies":{"react-scripts":"3.3.0","react-dev-utils":"10.0.0","node-sass":"4.14.1"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","predeploy":"npm run build","deploy":"gh-pages -d build"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},function(e,t,n){e.exports=n(19)},,,,,function(e,t,n){},function(e,t,n){},,,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(6),c=n.n(r),i=(n(13),n(3)),l=n(2),u=(n(14),a.a.createContext()),s=function(e){var t=function(e,t){return(e+"").padStart(t,"0")},n=parseFloat(e).toFixed(3),o=Math.floor(n/60/60),a=Math.floor(n/60)%60,r=Math.floor(n-60*a);return t(o,2)+":"+t(a,2)+":"+("000"+r).slice(-1*2)},d=n(20),m=n(21),f=n(22),p=n(23),g={li:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:".5rem",padding:".5rem",boxShadow:"1px 1px 4px 0px rgba(0,0,0,.5)"}};var b=function(e){var t=e.project,n=e.todo,o=(e.index,e.currentId),r=a.a.useContext(u),c=r.removeTodo,i=r.toggleTodo,l=r.toggleGo,b=r.toggleCheck,v=["todoTitle"];return n.completed&&v.push("done"),n.id===o&&v.push("go"),a.a.createElement("li",{style:g.li},a.a.createElement("span",{className:v.join(" ")},a.a.createElement("input",{type:"checkbox",onChange:b.bind(null,n.id)}),a.a.createElement("span",{className:"action goAction",onClick:l.bind(null,n.id)},n.id===o?a.a.createElement(d.a,{size:16,color:"red",strokeWidth:"2"}):a.a.createElement(m.a,{size:16,color:"blue",strokeWidth:"2"})),a.a.createElement("span",{className:"action doneAction",onClick:i.bind(null,n.id)},a.a.createElement(f.a,{size:16,color:"green",strokeWidth:"2"})),a.a.createElement("span",{className:"text duration"},s(n.duration)),a.a.createElement("span",{className:"text title"},a.a.createElement("strong",null,t.title,":"),"\xa0",n.title),a.a.createElement("span",{className:"text money"},Math.round(n.money))),a.a.createElement("button",{className:"action removeAction",onClick:c.bind(null,n.id)},a.a.createElement(p.a,{size:16,color:"red",strokeWidth:"2"})))},v={ul:{listStyle:"none",textAlign:"left",margin:0,padding:0,width:"100%"}};var E=function(e){return a.a.createElement("div",null,a.a.createElement("h3",null,e.title),a.a.createElement("ul",{style:v.ul},e.todos.map((function(t,n){var o=e.projects.find((function(e){return e.id===t.projectId}));return a.a.createElement(b,{currentId:e.currentId,project:o,todo:t,key:t.id,index:n})}))))},h=(n(17),n(24));var j=function(e){var t=e.isOpen,n=e.onClose,o=e.projects,r=e.onSelect,c=a.a.useContext(u).removeProject;return t?a.a.createElement("div",{className:"modal"},a.a.createElement("div",{className:"modal-body"},a.a.createElement("h2",null,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u043e\u0435\u043a\u0442"),a.a.createElement("ul",{className:"project-list"},o.map((function(e){return a.a.createElement("li",{key:e.id,className:"project-item",onClick:function(){r(e),n()}},e.title,": ",e.tariff,a.a.createElement("button",{className:"project-delete-button",onClick:function(t){t.stopPropagation(),window.confirm('\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442 "'.concat(e.title,'" \u0438 \u0432\u0441\u0435 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0441 \u043d\u0438\u043c \u0437\u0430\u0434\u0430\u0447\u0438?'))&&(c(e.id),n())}},a.a.createElement(h.a,{size:20,color:"red",strokeWidth:"2"})))}))),a.a.createElement("button",{onClick:n},"\xd7"))):null},S={form:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:".5rem",padding:".5rem",boxShadow:"1px 1px 4px 0px rgba(0,0,0,.5)"},input:{paddingLeft:"1rem",flexGrow:1,border:0,height:"1.5rem"},button:{cursor:"pointer",background:"#00FFA9",color:"#fff",border:0,height:"1.5rem"}};var y=function(e){var t=a.a.useContext(u).addTodo,n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=a.a.useState(e),n=Object(l.a)(t,2),o=n[0],r=n[1];return{bind:{value:o,onChange:function(e){return r(e.target.value)}},clear:function(){return r("")},title:function(){return o}}}(""),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=a.a.useState(e),n=Object(l.a)(t,2),o=n[0],r=n[1],c=a.a.useState(null),i=Object(l.a)(c,2),u=i[0],s=i[1];return{selectProject:function(e){r(e.id),s(e)},clear:function(){r(""),s(null)},projectId:o,selectedProject:u}}(""),r=a.a.useState(!1),c=Object(l.a)(r,2),s=c[0],d=c[1];return a.a.createElement("form",{style:S.form,onSubmit:function(e){e.preventDefault(),n.title().trim()&&o.projectId?(console.log("projectId: "+o.projectId),t(n.title(),o.projectId),n.clear(),o.clear()):alert("\u041d\u0443\u0436\u043d\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0438 \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442")}},a.a.createElement("div",null,"\u0417\u0430\u0434\u0430\u0447\u0443"),a.a.createElement("input",Object.assign({placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438",style:S.input},n.bind)),a.a.createElement("button",{type:"button",style:Object(i.a)(Object(i.a)({},S.input),{},{cursor:"pointer",background:o.selectedProject?"#fff":"#f5f5f5"}),onClick:function(){return d(!0)}},o.selectedProject?"".concat(o.selectedProject.title,": ").concat(o.selectedProject.tariff):"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u043e\u0435\u043a\u0442..."),a.a.createElement(j,{isOpen:s,onClose:function(){return d(!1)},projects:e.projects,onSelect:o.selectProject}),a.a.createElement("button",{style:S.button,type:"submit"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443"))},k={form:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:".5rem",padding:".5rem",boxShadow:"1px 1px 4px 0px rgba(0,0,0,.5)"},input:{paddingLeft:"1rem",flexGrow:1,border:0,height:"1.5rem"},button:{cursor:"pointer",background:"#293685",color:"#fff",border:0,height:"1.5rem"}};function I(){var e=a.a.useContext(u).addProject,t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=a.a.useState(e),n=Object(l.a)(t,2),o=n[0],r=n[1];return{bind:{value:o,onChange:function(e){return r(e.target.value)}},clear:function(){return r("")},title:function(){return o}}}(""),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=a.a.useState(e),n=Object(l.a)(t,2),o=n[0],r=n[1];return{bind:{value:o,onChange:function(e){return r(e.target.value)}},clear:function(){return r("")},tariff:function(){return o}}}("");return a.a.createElement("form",{style:k.form,onSubmit:function(o){o.preventDefault(),t.title().trim()?(e(t.title(),n.tariff()),t.clear(),n.clear()):alert("\u041d\u0443\u0436\u043d\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435")}},a.a.createElement("div",null,"\u041f\u0440\u043e\u0435\u043a\u0442"),a.a.createElement("input",Object.assign({placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430",style:k.input},t.bind)),a.a.createElement("input",Object.assign({placeholder:"\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0447\u0430\u0441\u0430",style:k.input},n.bind)),a.a.createElement("button",{style:k.button,type:"submit"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442"))}var x=function(e){var t=document.querySelector('link[rel="shortcut icon"]')||document.querySelector('link[rel="icon"]');t||((t=document.createElement("link")).id="favicon",t.rel="shortcut icon",document.head.appendChild(t)),t.href=e};n(18);var O=function(e){var t=a.a.useContext(u).setIsModalOpen,n=e.projects.map((function(t){var n=e.todos.map((function(e){return e.projectId===t.id?e.tmpDuration:0})).reduce((function(e,t){return e+t}),0);return{id:t.id,title:t.title,tmpDuration:n}}));return a.a.createElement(a.a.Fragment,null,e.isOpen&&a.a.createElement("div",{className:"modal"},a.a.createElement("div",{className:"modal-body"},a.a.createElement("h2",null,"\u041f\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430\u043c"),n.map((function(e){if(e.tmpDuration)return a.a.createElement("p",{key:e.id},e.title,": ~",s(e.tmpDuration))})),a.a.createElement("button",{onClick:function(){return t(!1)}},"\xd7"))))},w=n(7),N=n(25),C={buttons:{padding:0,marginLeft:"auto",alignItems:"center"},button:{cursor:"pointer",color:"#e91615",background:"transparent",border:"2px solid",borderRadius:"3px",height:"1.5rem"},button2:{marginLeft:".5rem",color:"#40a040"},button3:{background:"transparent"}},T=document.title,D=["[\u25b6]","[\u25c0]"],M=0;var P=function(){var e=a.a.useState([]),t=Object(l.a)(e,2),n=t[0],o=t[1],r=a.a.useState([]),c=Object(l.a)(r,2),d=c[0],m=c[1],f=a.a.useState([]),p=Object(l.a)(f,2),g=p[0],b=p[1],v=a.a.useState(0),h=Object(l.a)(v,2),j=h[0],S=h[1],k=a.a.useState(0),P=Object(l.a)(k,2),L=P[0],J=P[1],A=a.a.useState(0),G=Object(l.a)(A,2),B=G[0],F=G[1],R=a.a.useState(!1),z=Object(l.a)(R,2),W=z[0],U=z[1],q=a.a.useState(0),H=Object(l.a)(q,2),Y=H[0],_=H[1],K=a.a.useState(0),Q=Object(l.a)(K,2),V=Q[0],X=Q[1],Z=a.a.useState(null),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ne=a.a.useState(Notification.permission),oe=Object(l.a)(ne,2),ae=oe[0],re=oe[1];a.a.useEffect((function(){"default"===Notification.permission&&Notification.requestPermission().then((function(e){re(e)}))}),[]),a.a.useEffect((function(){var e=localStorage.getItem("todos");e&&o(JSON.parse(e));var t=localStorage.getItem("projects");t&&m(JSON.parse(t));var n=localStorage.getItem("totalTime");n&&S(n)}),[]),a.a.useEffect((function(){localStorage.setItem("todos",JSON.stringify(n))}),[n]),a.a.useEffect((function(){localStorage.setItem("projects",JSON.stringify(d))}),[d]),a.a.useEffect((function(){localStorage.setItem("totalTime",j)}),[j]),a.a.useEffect((function(){if(console.log(L),L){clearInterval(B),x("./favicon-go.ico");var e=Date.now();F(setInterval((function(){document.title=D[M]+" "+T,M=(M+1)%2,o(n.map((function(t){if(t.id===L){t.durationMs||(t.durationMs=1e3*t.duration);var n=Date.now()-e;t.durationMs+=n,e=Date.now(),t.duration=Math.round(t.durationMs/1e3),t.tmpDuration++,t.duration%60===0&&(t.money+=t.minuteCost),S((function(e){return parseInt(e,10)+1}))}return t})))}),1e3))}else clearInterval(B),x("./favicon.ico"),document.title=T}),[L]),a.a.useEffect((function(){!function(){var e=0,t=0;console.log(g),n.map((function(n){-1!==g.indexOf(n.id)&&(e+=n.duration,t+=n.money)})),_(e),X(t)}()}),[g]);var ce=a.a.useCallback((function(e){console.log("toggleTodo "+e),o(n.map((function(t){return t.id===e&&(t.completed=!t.completed,t.completed&&e===L&&J(0)),t})))}),[L,J,o,n]),ie=a.a.useCallback((function(e){console.log("toggleGo "+e);for(var t=function(t){var o=n[t];if(o.id===e&&!o.completed){var a=d.find((function(e){return e.id===o.projectId})),r=a?"".concat(a.title,": ").concat(o.title):o.title;if(e===L){if(J(0),"granted"===ae)try{new Notification("".concat("\ud83e\uddd8"," \u041e\u0421\u0422\u0410\u041d\u041e\u0412\u041b\u0415\u041d\u041e: ").concat(r),{body:"\u0417\u0430\u0434\u0430\u0447\u0430 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430.",silent:!0})}catch(c){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043a\u0430\u0437\u0435 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f (\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430):",c)}}else if(te(e),J(e),"granted"===ae)try{new Notification("".concat("\ud83d\udc68\u200d\ud83d\udcbb"," \u0417\u0410\u041f\u0423\u0429\u0415\u041d\u041e: ").concat(r),{body:"\u0417\u0430\u0434\u0430\u0447\u0430 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430.",silent:!0})}catch(c){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043a\u0430\u0437\u0435 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f (\u0437\u0430\u043f\u0443\u0441\u043a):",c)}return"break"}},o=0;o<n.length;o++){if("break"===t(o))break}}),[L,n,d,ae,J,te]),le=a.a.useCallback((function(){null!==ee?n.find((function(e){return e.id===ee}))?(console.log("toggleLastGo: \u041f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u0442\u0430\u0439\u043c\u0435\u0440 \u0434\u043b\u044f Todo \u0441 ID ".concat(ee)),ie(ee)):console.log("toggleLastGo: Todo \u0441 ID ".concat(ee," \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d")):console.log("toggleLastGo: lastStartedTodoId \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d")}),[ee,n,ie]);function ue(e){console.log("removeProject "+e),m(d.filter((function(t){return t.id!==e}))),o(n.filter((function(t){return t.projectId!==e}))),localStorage.setItem("projects",JSON.stringify(d)),localStorage.setItem("todos",JSON.stringify(n))}a.a.useEffect((function(){var e=function(e){"hotkey1"===e.detail.data.hotkey&&le()};return window.addEventListener("globalHotkey",e),function(){window.removeEventListener("globalHotkey",e)}}),[le]);var se=n.filter((function(e){return!e.completed})),de=n.filter((function(e){return e.completed})),me={toggleCheck:function(e,t){t.target.checked?b(g.concat([e])):b(g.filter((function(t){return t!==e})))},removeTodo:function(e){console.log("removeTodo "+e),o(n.filter((function(t){return t.id!==e})))},toggleTodo:ce,addTodo:function(e,t){console.log("addTodo "+e),t=parseInt(t,10);var a=d.find((function(e){return e.id===t}));o(n.concat([{id:Date.now(),projectId:t,title:e,completed:!1,duration:0,durationMs:0,money:0,minuteCost:parseInt(a.tariff,10)/60,tmpDuration:0}]))},editTodo:function(e,t){console.log("editTodo "+e);var a=n.findIndex((function(t){return t.id===e}));console.log(n[a].title=t),o(n)},addProject:function(e,t){console.log("addProject "+e),m(d.concat([{id:Date.now(),title:e,tariff:parseInt(t,10)}]))},toggleGo:ie,setIsModalOpen:U,removeProject:ue};return a.a.createElement(u.Provider,{value:me},a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("div",null,a.a.createElement("div",{style:{padding:0}},a.a.createElement("img",{src:"./time-2-32.png",alt:"Tasknik"}),"\xa0 Tasknik v.",w.version),a.a.createElement("div",{style:C.buttons},a.a.createElement("button",{style:C.button,onClick:function(){return function(){if(window.confirm("\u0412\u0441\u0435 \u0437\u0430\u0434\u0430\u0447\u0438, \u043f\u0440\u043e\u0435\u043a\u0442\u044b \u0438 \u0442\u0430\u0439\u043c\u0435\u0440\u044b \u0431\u0443\u0434\u0443\u0442 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0441\u0430\u043d\u044b. \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c?")){J(0);var e=document.createElementNS("http://www.w3.org/1999/xhtml","input");e.type="file",e.accept="application/json",e.addEventListener("change",(function(){if(e.files&&e.files[0]){var t=e.files[0],n=new FileReader;n.addEventListener("load",(function(e){try{var t=JSON.parse(e.target.result);localStorage.setItem("totalTime",t.totalTime);var n=JSON.parse(t.todos).map((function(e){return e.durationMs||(e.durationMs=1e3*e.duration),e}));localStorage.setItem("todos",JSON.stringify(n)),localStorage.setItem("projects",t.projects),window.location.reload()}catch(e){console.error(e),window.alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0444\u0430\u0439\u043b")}})),n.readAsText(t)}e=null})),e.dispatchEvent(new MouseEvent("click"))}}()},type:"button"},"\u0418\u043c\u043f\u043e\u0440\u0442"),a.a.createElement("button",{style:Object(i.a)(Object(i.a)({},C.button),C.button2),onClick:function(){return function(){var e=JSON.stringify({totalTime:localStorage.getItem("totalTime"),todos:localStorage.getItem("todos"),projects:localStorage.getItem("projects")}),t=new Date,n="tasknik ";if(n+="".concat(t.getDate().toString().padStart(2,"0"),"-").concat((t.getMonth()+1).toString().padStart(2,"0"),"-").concat(t.getFullYear()),n+=" ".concat(t.getHours().toString().padStart(2,"0"),"-").concat(t.getMinutes().toString().padStart(2,"0"),"-").concat(t.getSeconds().toString().padStart(2,"0")),n+=".json","function"==typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,n);var o=document.createElementNS("http://www.w3.org/1999/xhtml","a"),a=URL.createObjectURL(new Blob([e],{type:"application/json"}));o.href=a,o.download=n,o.dispatchEvent(new MouseEvent("click")),URL.revokeObjectURL(a),o=null}()},type:"button"},"\u042d\u043a\u0441\u043f\u043e\u0440\u0442")))),a.a.createElement("div",{className:"App-content"},a.a.createElement("div",null,se.length?a.a.createElement(E,{title:"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0435",todos:se,projects:d,currentId:L}):a.a.createElement("p",null,"\u041d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447"),a.a.createElement("h3",null,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),a.a.createElement(y,{projects:d}),a.a.createElement(I,null),de.length?a.a.createElement(E,{title:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u044b\u0435",todos:de,projects:d,currentId:L}):a.a.createElement("p",null,"\u041d\u0435\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u0447"))),a.a.createElement("footer",{className:"App-footer"},a.a.createElement("div",{className:"totalTimer",onClick:function(){return U(!0)}},"\u0412\u0441\u0435\u0433\u043e: ~",s(j)," \xa0"),a.a.createElement("span",{title:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043e\u0431\u0449\u0438\u0439 \u0442\u0430\u0439\u043c\u0435\u0440",className:"action resetTotalAction",onClick:function(){return S(0),void o(n.map((function(e){return e.tmpDuration=0,e})))}},a.a.createElement(N.a,{size:16,color:"orange",strokeWidth:"2"})),a.a.createElement("div",{style:Object(i.a)(Object(i.a)({},C.buttons),{},{paddingRight:"2rem"})},a.a.createElement("span",null,"\u0418\u0442\u043e\u0433 \u043f\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u043c: ",s(Y)," / ",Math.round(V))))),a.a.createElement(O,{isOpen:W,todos:n,projects:d,removeProject:ue}))};c.a.render(a.a.createElement(P,null),document.getElementById("root"))}],[[8,1,2]]]);
//# sourceMappingURL=main.20f9a0ce.chunk.js.map